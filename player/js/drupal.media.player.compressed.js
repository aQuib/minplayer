Drupal.media=Drupal.media||{};(function(d){function a(a,b){if(typeof a.canPlayType==="function"){var e=a.canPlayType(b);return"no"!==e&&""!==e}else return false}function b(){var c={},b=null,b=document.createElement("video");c.videoOGG=a(b,"video/ogg");c.videoH264=a(b,"video/mp4");c.videoWEBM=a(b,"video/x-webm");b=document.createElement("audio");c.audioOGG=a(b,"audio/ogg");c.audioMP3=a(b,"audio/mpeg");c.audioMP4=a(b,"audio/mp4");return c}if(!d.playTypes)d.playTypes=b()})(Drupal.media);
Drupal.media=Drupal.media||{};(function(d,a){a.flags=function(){this.flag=0;this.ids={};this.numFlags=0};a.flags.prototype=jQuery.extend(a.flags.prototype,{setFlag:function(a,c){if(!this.ids.hasOwnProperty(a))this.ids[a]=this.numFlags,this.numFlags++;c?this.flag|=1<<this.ids[a]:this.flag&=~(1<<this.ids[a])}})})(jQuery,Drupal.media);Drupal.media=Drupal.media||{};
(function(d,a){a.plugin=function(a){this.player=null;a&&this.construct()};a.plugin.prototype=jQuery.extend(a.plugin.prototype,{construct:function(){},setPlayer:function(a){this.player=a}})})(jQuery,Drupal.media);Drupal.media=Drupal.media||{};
(function(d,a){a.display=function(b,c){if(b)this.display=d(b),this.options=c,this.options.elements=this.options.elements||{},jQuery.extend(this.options.elements,this.getElements()),this.elements=this.options.elements;a.plugin.call(this,b,c)};a.display.prototype=new a.plugin;a.display.prototype.constructor=a.display;a.display.prototype=jQuery.extend(a.display.prototype,{getElements:function(){return{}},isValid:function(){return this.display.length>0}})})(jQuery,Drupal.media);
Drupal.media=Drupal.media||{};
(function(d,a){if(!d.fn.mediaplayer)d.fn.mediaplayer=function(b){return d(this).each(function(){a.player[d(this).selector]||new a.player(d(this),b)})};a.player=function(b,c){c=jQuery.extend({id:"player",controller:"default",template:"default",volume:80,swfplayer:"",wmode:"transparent",attributes:{},settings:{}},c);c.player=this;a.player[c.id]=this;a.display.call(this,b,c)};a.player.prototype=new a.display;a.player.prototype.constructor=a.player;a.player.prototype=jQuery.extend(a.player.prototype,{construct:function(){a.display.prototype.construct.call(this);
var b={},c=null,c=null,g=a.plugins.length,e=[];this.media=b=null;for(this.allPlugins={};g--;)b=a.plugins[g],c=b.element?jQuery(b.element,this.display):this.display,c=new b.object(c,this.options),this.addPlugin(b.id,c);this.currentPlayer="html5";this.elements.player&&((b=this.elements.player.attr("src"))&&e.push({path:b}),d("source",this.elements.player).each(function(){e.push({path:d(this).attr("src"),mimetype:d(this).attr("type"),codecs:d(this).attr("codecs")})}));this.load(e)},getMediaFile:function(b){if(typeof b===
"string")return new a.file({path:b});if(b.path)return new a.file(b);for(var c=b.length,g=null,e=null;c--;)e=b[c],e=typeof e==="string"?new a.file({path:e}):new a.file(e),e.priority>0&&(g=e);return g},load:function(b){var b=this.getMediaFile(b),c="",g="";if(b){if(!this.media||b.player.toString()!==this.currentPlayer){this.currentPlayer=b.player.toString();this.media&&this.media.destroy();if(this.elements.display)g=a.players[b.player],this.media=new g(this.elements.display,this.options,b);for(c in this.allPlugins)this.allPlugins.hasOwnProperty(c)&&
this.allPlugins[c].setPlayer(this.media)}this.media&&this.media.load(b)}},addPlugin:function(a,c){c.isValid()&&(this.allPlugins[a]=c)},getPlugin:function(a){return this.allPlugins[a]},play:function(){this.media&&this.media.play()},pause:function(){this.media&&this.media.pause()},stop:function(){this.media&&this.media.stop()},seek:function(a){this.media&&this.media.seek(a)},setVolume:function(a){this.media&&this.media.setVolume(a)},getVolume:function(){return this.media?this.media.getVolume():0},getDuration:function(){return this.media?
this.media.getDuration():0}})})(jQuery,Drupal.media);Drupal.media=Drupal.media||{};
(function(d){d.file=function(a){this.duration=a.duration||0;this.bytesTotal=a.bytesTotal||0;this.quality=a.quality||0;this.stream=a.stream||"";this.path=a.path||"";this.codecs=a.codecs||"";this.extension=a.extension||this.getFileExtension();this.mimetype=a.mimetype||this.getMimeType();this.type=a.type||this.getType();this.player=a.player||this.getBestPlayer();this.priority=a.priority||this.getPriority()};d.file.prototype=jQuery.extend(d.file.prototype,{getBestPlayer:function(){var a=null,b=0,c=this;
jQuery.each(d.players,function(g,e){var f=e.getPriority();e.canPlay(c)&&f>b&&(a=g,b=f)});return a},getPriority:function(){var a=1;this.player&&(a=d.players[this.player].getPriority());switch(this.mimetype){case "video/x-webm":return a*10;case "video/mp4":case "audio/mp4":case "audio/mpeg":return a*9;case "video/ogg":case "audio/ogg":case "video/quicktime":return a*8;default:return a*5}},getFileExtension:function(){return this.path.substring(this.path.lastIndexOf(".")+1).toLowerCase()},getMimeType:function(){switch(this.extension){case "mp4":case "m4v":case "flv":case "f4v":return"video/mp4";
case "webm":return"video/x-webm";case "ogg":case "ogv":return"video/ogg";case "3g2":return"video/3gpp2";case "3gpp":case "3gp":return"video/3gpp";case "mov":return"video/quicktime";case "swf":return"application/x-shockwave-flash";case "oga":return"audio/ogg";case "mp3":return"audio/mpeg";case "m4a":case "f4a":return"audio/mp4";case "aac":return"audio/aac";case "wav":return"audio/vnd.wave";case "wma":return"audio/x-ms-wma";default:return"unknown"}},getType:function(){switch(this.mimetype){case "video/mp4":case "video/x-webm":case "video/ogg":case "video/3gpp2":case "video/3gpp":case "video/quicktime":return"video";
case "audio/mp3":case "audio/mp4":case "audio/ogg":return"audio";default:return"unknown"}}})})(Drupal.media);Drupal.media=Drupal.media||{};
(function(d,a){a.playLoader=a.playLoader||{};a.playLoader.base=function(c,b){this.busy=new a.flags;this.bigPlay=new a.flags;a.display.call(this,c,b)};var b=a.playLoader.base;b.prototype=new a.display;b.prototype.constructor=b;b.prototype=jQuery.extend(b.prototype,{construct:function(){a.display.prototype.construct.call(this);this.elements.bigPlay&&this.elements.bigPlay.bind("click",{obj:this},function(a){a.preventDefault();d(this).hide();a.data.obj.player&&a.data.obj.player.play()})},checkVisibility:function(){this.busy.flag?
this.elements.busy.show():this.elements.busy.hide();this.bigPlay.flag?this.elements.bigPlay.show():this.elements.bigPlay.hide();(this.bigPlay.flag||this.busy.flag)&&this.display.show();!this.bigPlay.flag&&!this.busy.flag&&this.display.hide()},setPlayer:function(c){a.display.prototype.setPlayer.call(this,c);var b=this;c.display.bind("loadstart",function(){b.busy.setFlag("media",true);b.bigPlay.setFlag("media",true);b.checkVisibility()});c.display.bind("waiting",function(){b.busy.setFlag("media",true);
b.checkVisibility()});c.display.bind("loadedmetadata",function(){b.busy.setFlag("media",false);b.checkVisibility()});c.display.bind("loadeddata",function(){b.busy.setFlag("media",false);b.checkVisibility()});c.display.bind("playing",function(){b.busy.setFlag("media",false);b.bigPlay.setFlag("media",false);b.checkVisibility()});c.display.bind("pause",function(){b.bigPlay.setFlag("media",true);b.checkVisibility()})}})})(jQuery,Drupal.media);Drupal.media=Drupal.media||{};
(function(d,a){a.players=a.players||{};a.players.base=function(b,c,g){this.mediaFile=g;a.display.call(this,b,c)};a.players.base.getPriority=function(){return 0};a.players.base.canPlay=function(){return false};a.players.base.prototype=new a.display;a.players.base.prototype.constructor=a.players.base;a.players.base.prototype=jQuery.extend(a.players.base.prototype,{construct:function(){a.display.prototype.construct.call(this);this.playerFound()||(this.display.unbind(),this.elements.player&&this.elements.player.remove(),
this.display.html(this.create()));this.player=this.getPlayer();this.trigger=function(a,c){this.display.trigger(a,c)};this.currentTime=this.duration=0},playerFound:function(){return false},create:function(){return null},getPlayer:function(){return null},destroy:function(){},load:function(a){this.mediaFile=a},play:function(){},pause:function(){},stop:function(){},seek:function(){},setVolume:function(a){this.trigger("volumeupdate",a)},getVolume:function(){return 0},getDuration:function(){return 0}})})(jQuery,
Drupal.media);Drupal.media=Drupal.media||{};
(function(d,a){a.players=a.players||{};a.players.html5=function(b,c,g){a.players.base.call(this,b,c,g)};a.players.html5.getPriority=function(){return 10};a.players.html5.canPlay=function(b){switch(b.mimetype){case "video/ogg":return a.playTypes.videoOGG;case "video/mp4":return a.playTypes.videoH264;case "video/x-webm":return a.playTypes.videoWEBM;case "audio/ogg":return a.playTypes.audioOGG;case "audio/mpeg":return a.playTypes.audioMP3;case "audio/mp4":return a.playTypes.audioMP4;default:return false}};
a.players.html5.prototype=new a.players.base;a.players.html5.prototype.constructor=a.players.html5;a.players.html5.prototype=jQuery.extend(a.players.html5.prototype,{construct:function(){a.players.base.prototype.construct.call(this);this.loaded=false;var b=this;if(this.player)this.player.addEventListener("abort",function(){b.trigger("abort")},true),this.player.addEventListener("loadstart",function(){b.trigger("loadstart")},true),this.player.addEventListener("loadeddata",function(){b.trigger("loadeddata")},
true),this.player.addEventListener("loadedmetadata",function(){b.trigger("loadedmetadata")},true),this.player.addEventListener("canplaythrough",function(){b.trigger("canplaythrough")},true),this.player.addEventListener("ended",function(){b.trigger("ended")},true),this.player.addEventListener("pause",function(){b.trigger("pause")},true),this.player.addEventListener("play",function(){b.trigger("play")},true),this.player.addEventListener("playing",function(){b.trigger("playing")},true),this.player.addEventListener("error",
function(){b.trigger("error")},true),this.player.addEventListener("waiting",function(){b.trigger("waiting")},true),this.player.addEventListener("timeupdate",function(){var a=this.duration,g=this.currentTime;b.duration=a;b.currentTime=g;b.trigger("timeupdate",{currentTime:g,duration:a})},true),this.player.addEventListener("durationchange",function(){b.duration=this.duration;b.trigger("durationchange",{duration:this.duration})},true),this.player.addEventListener("progress",function(a){b.trigger("progress",
{loaded:a.loaded,total:a.total})},true),this.autoBuffer()?this.player.autobuffer=true:(this.player.autobuffer=false,this.player.preload="none")},autoBuffer:function(){var a=this.player.preload!=="none";return typeof this.player.hasAttribute==="function"?this.player.hasAttribute("preload")&&a:false},playerFound:function(){return this.display.find(this.mediaFile.type).length>0},create:function(){var a=document.createElement(this.mediaFile.type),c="";for(c in this.options.attributes)this.options.attributes.hasOwnProperty(c)&&
a.setAttribute(c,this.options.attributes[c]);return a},getPlayer:function(){return this.options.elements.player.eq(0)[0]},load:function(b){a.players.base.prototype.load.call(this,b);if(this.loaded){var c='<source src="'+b.path+'" ';c+='type="'+b.mimetype+'"';c+=b.codecs?' codecs="'+b.path+'">':">";this.options.elements.player.attr("src","").empty().html(c)}this.loaded=true},play:function(){a.players.base.prototype.play.call(this);this.player.play()},pause:function(){a.players.base.prototype.pause.call(this);
this.player.pause()},stop:function(){a.players.base.prototype.stop.call(this);this.media.pause();this.player.src=""},seek:function(b){a.players.base.prototype.seek.call(this,b);this.player.currentTime=b},setVolume:function(b){a.players.base.prototype.setVolume.call(this,b);this.player.volume=b},getVolume:function(){return this.player.volume},getDuration:function(){var a=this.player.duration;return a===Infinity?0:a}})})(jQuery,Drupal.media);Drupal.media=Drupal.media||{};
(function(d,a){a.players=a.players||{};a.players.flash=function(c,b,e){var f=this,d=null,i=null;this.duration=0;this.onReady=function(){this.ready=true;this.trigger("loadstart");i=setInterval(function(){f.getDuration()&&(clearInterval(i),f.trigger("durationchange",{duration:f.getDuration()}))},1E3)};this.onMediaUpdate=function(a){if(this.ready)switch(a){case "mediaMeta":clearInterval(i);this.trigger("loadeddata");this.trigger("loadedmetadata");this.trigger("durationchange",{duration:this.getDuration()});
break;case "mediaPlaying":this.trigger("playing");d=setInterval(function(){var a=f.getCurrentTime(),c=f.getDuration();f.trigger("timeupdate",{currentTime:a,duration:c})},1E3);break;case "mediaPaused":this.trigger("pause"),clearInterval(d)}};a.players.base.call(this,c,b,e)};window.onFlashPlayerReady=function(c){if(a.player[c])a.player[c].media.onReady()};window.onFlashPlayerUpdate=function(c,b){if(a.player[c])a.player[c].media.onMediaUpdate(b)};var b=console||{log:function(){}};window.onFlashPlayerDebug=
function(a){b.log(a)};a.players.flash.getPriority=function(){return 1};a.players.flash.canPlay=function(a){switch(a.mimetype){case "video/mp4":case "video/x-webm":case "video/quicktime":case "video/3gpp2":case "video/3gpp":case "application/x-shockwave-flash":case "audio/mpeg":case "audio/mp4":case "audio/aac":case "audio/vnd.wave":case "audio/x-ms-wma":return true;default:return false}};a.players.flash.getFlash=function(a){var b=window.location.protocol,e=null,f=null,d="",i={},f=null;b.charAt(b.length-
1)===":"&&b.substring(0,b.length-1);e=document.createElement("object");e.setAttribute("width",a.width);e.setAttribute("height",a.height);e.setAttribute("id",a.id);e.setAttribute("name",a.id);e.setAttribute("playerType",a.playerType);i={allowScriptAccess:"always",allowfullscreen:"true",movie:a.swf,wmode:a.wmode,quality:"high",FlashVars:jQuery.param(a.flashvars)};for(d in i)i.hasOwnProperty(d)&&(f=document.createElement("param"),f.setAttribute("name",d),f.setAttribute("value",i[d]),e.appendChild(f));
f=document.createElement("embed");for(d in i)i.hasOwnProperty(d)&&(d=d==="movie"?"src":d,f.setAttribute(d,i[d]));f.setAttribute("width",a.width);f.setAttribute("height",a.height);f.setAttribute("id",a.id);f.setAttribute("name",a.id);f.setAttribute("swLiveConnect","true");f.setAttribute("type","application/x-shockwave-flash");e.appendChild(f);return e};a.players.flash.prototype=new a.players.base;a.players.flash.prototype.constructor=a.players.flash;a.players.flash.prototype=jQuery.extend(a.players.flash.prototype,
{reset:function(){this.ready=false;this.duration=0},destroy:function(){this.reset()},playerFound:function(){return this.display.find('object[playerType="flash"]').length>0},create:function(){this.reset();return a.players.flash.getFlash({swf:this.options.swfplayer,id:this.options.id+"_player",playerType:"flash",width:this.options.settings.width,height:"100%",flashvars:{id:this.options.id,debug:this.options.settings.debug,config:"nocontrols",file:this.mediaFile.path,autostart:this.options.settings.autoplay},
wmode:this.options.wmode})},getPlayer:function(){return d(jQuery.browser.msie?"object":"embed",this.display).eq(0)[0]},load:function(b){this.duration=0;a.players.base.prototype.load.call(this,b);this.player&&this.ready&&this.player.loadMedia(this.mediaFile.path,this.mediaFile.stream)},play:function(){a.players.base.prototype.play.call(this);this.player&&this.ready&&this.player.playMedia()},pause:function(){a.players.base.prototype.pause.call(this);this.player&&this.ready&&this.player.pauseMedia()},
stop:function(){a.players.base.prototype.stop.call(this);this.player&&this.ready&&this.player.stopMedia()},seek:function(b){a.players.base.prototype.seek.call(this,b);this.player&&this.ready&&this.player.seekMedia(b)},setVolume:function(b){a.players.base.prototype.setVolume.call(this,b);this.player&&this.ready&&this.player.setVolume(b)},getVolume:function(){return this.player&&this.ready?this.player.getVolume():a.players.base.prototype.getVolume.call(this)},getDuration:function(){return this.duration?
this.duration:this.player&&this.ready?(this.duration=this.player.getDuration(),this.player.getDuration()):a.players.base.prototype.getDuration.call(this)},isReady:function(){return this.player&&this.ready},getCurrentTime:function(){return this.isReady()?this.player.getCurrentTime():0},getBytesLoaded:function(){return this.isReady()?this.player.getMediaBytesLoaded():0},getBytesTotal:function(){return this.isReady()?this.player.getMediaBytesTotal():0}})})(jQuery,Drupal.media);
Drupal.media=Drupal.media||{};
(function(d,a){a.controllers=a.controllers||{};a.controllers.base=function(b,d){a.display.call(this,b,d)};a.formatTime=function(a){var a=a||0,b=0,e=0,d=0,h="",d=Math.floor(a/3600);a-=d*3600;e=Math.floor(a/60);a-=e*60;b=Math.floor(a%60);d&&(h+=String(d),h+=":");h+=e>=10?String(e):"0"+String(e);h+=":";h+=b>=10?String(b):"0"+String(b);return{time:h,units:""}};var b=a.controllers.base;b.prototype=new a.display;b.prototype.constructor=b;b.prototype=jQuery.extend(b.prototype,{getElements:function(){var b=
a.display.prototype.getElements.call(this);return jQuery.extend(b,{play:null,pause:null,fullscreen:null,seek:null,volume:null,timer:null})},construct:function(){a.display.prototype.construct.call(this);this.setPlayPause=function(a){var b="";this.elements.play&&this.elements.play.css("display",a?"inherit":"none");this.elements.pause&&this.elements.pause.css("display",a?"none":"inherit")};this.playPause=function(a){var b=a?"play":"pause";this.display.trigger(b);this.setPlayPause(a);if(this.player)this.player[b]()};
this.elements.play&&this.elements.play.bind("click",{obj:this},function(a){a.preventDefault();a.data.obj.playPause(true)});this.elements.pause&&this.elements.pause.bind("click",{obj:this},function(a){a.preventDefault();a.data.obj.playPause(false)});var b=this,g={};this.elements.fullscreen&&this.elements.fullscreen.click(function(){d(b.options.player.display).hasClass("fullscreen")?d(b.options.player.display).removeClass("fullscreen"):d(b.options.player.display).addClass("fullscreen")}).css({pointer:"hand"});
d(window).keyup(function(a){d(b.options.player.display).hasClass("fullscreen")&&(a.keyCode===113||a.keyCode===27)&&d(b.options.player.display).removeClass("fullscreen")});this.dragging=false;if(this.elements.seek)this.seekBar=this.elements.seek.slider({range:"min"});if(this.elements.volume)g={range:"min",orientation:"vertical"},this.volumeBar=this.elements.volume.slider(g)},setTimeString:function(b,d){this.elements[b]&&this.elements[b].text(a.formatTime(d).time)},setPlayer:function(b){a.display.prototype.setPlayer.call(this,
b);b.display.bind("pause",{obj:this},function(a){a.data.obj.setPlayPause(true);clearInterval(a.data.obj.interval)});b.display.bind("playing",{obj:this},function(a){a.data.obj.setPlayPause(false)});b.display.bind("durationchange",{obj:this},function(a,b){a.data.obj.setTimeString("duration",b.duration)});b.display.bind("timeupdate",{obj:this},function(a,b){if(!a.data.obj.dragging){var c=0;b.duration&&(c=b.currentTime/b.duration*100);a.data.obj.seekBar&&a.data.obj.seekBar.slider("option","value",c);
a.data.obj.setTimeString("timer",b.currentTime)}});if(this.seekBar){var d=this;this.seekBar.slider({start:function(){d.dragging=true},stop:function(a,f){d.dragging=false;var h=f.value/100*b.getDuration();b.seek(h)},slide:function(a,f){var h=f.value/100*b.getDuration();d.dragging||b.seek(h);d.setTimeString("timer",h)}})}b.setVolume(this.options.volume/100);this.volumeBar&&(this.volumeBar.slider("option","value",this.options.volume),this.volumeBar.slider({slide:function(a,d){b.setVolume(d.value/100)}}))}})})(jQuery,
Drupal.media);Drupal.media=Drupal.media||{};(function(d,a){a.templates=a.templates||{};a.templates.base=function(b,d){a.display.call(this,b,d)};var b=a.templates.base;b.prototype=new a.display;b.prototype.constructor=b;b.prototype=jQuery.extend(b.prototype,{getElements:function(){var b=a.display.prototype.getElements.call(this);return jQuery.extend(b,{display:null,player:null})},onFullScreen:function(){}})})(jQuery,Drupal.media);
